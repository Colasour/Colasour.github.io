(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{276:function(t,s,a){"use strict";a.r(s);var n=a(35),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"frontmatter-title"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#frontmatter-title"}},[t._v("#")]),t._v(" "+t._s(t.$frontmatter.title))]),t._v(" "),n("h2",{attrs:{id:"xss-攻击"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#xss-攻击"}},[t._v("#")]),t._v(" XSS 攻击")]),t._v(" "),n("p",[n("strong",[t._v("跨网站指令码 (Cross-site scripting, XSS)")]),t._v(" 是一种网站应用程序的安全漏洞攻击，是往 HTML 文件中或者 DOM 中注入恶意脚本，从而在用户浏览页面时利用注入的恶意脚本对用户实施攻击的一种手段。")]),t._v(" "),n("p",[t._v("当页面被注入了恶意 JavaScript 脚本时，浏览器无法区分这些脚本是被恶意注入的还是正常的页面内容，所以恶意注入 JavaScript 脚本也拥有所有的脚本权限。")]),t._v(" "),n("ul",[n("li",[n("p",[n("strong",[t._v("窃取 Cookie 信息")])]),t._v(" "),n("p",[t._v("恶意 JavaScript 可以通过 "),n("code",[t._v("document.cookie")]),t._v(" 获取 Cookie 信息，然后通过 "),n("code",[t._v("XMLHttpRequest")]),t._v(" 或者 "),n("code",[t._v("Fetch")]),t._v(" 加上 CORS 功能将数据发送给恶意服务器。")]),t._v(" "),n("p",[t._v("恶意服务器拿到用户的 Cookie 信息之后，就可以在其他电脑上模拟用户的登录，然后进行转账等操作。")])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("监听用户行为")])]),t._v(" "),n("p",[t._v("恶意 JavaScript 可以使用 "),n("code",[t._v("addEventListener")]),t._v(" 接口来监听键盘事件，比如获取用户输入的信用卡等信息，将其发送到恶意服务器。")])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("修改 DOM")])]),t._v(" "),n("p",[t._v("通过修改 DOM 伪造假的登录窗口，用来欺骗用户输入用户名和密码等信息。")])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("在页面内生成浮窗广告")])]),t._v(" "),n("p",[t._v("这些广告会严重地影响用户体验。")])])]),t._v(" "),n("h2",{attrs:{id:"攻击方式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#攻击方式"}},[t._v("#")]),t._v(" 攻击方式")]),t._v(" "),n("p",[t._v("通常情况下，主要有"),n("strong",[t._v("存储型 XSS 攻击")]),t._v("、"),n("strong",[t._v("反射型 XSS 攻击")]),t._v("和"),n("strong",[t._v("基于 DOM 的 XSS 攻击")]),t._v("三种方式来注入恶意脚本。")]),t._v(" "),n("h3",{attrs:{id:"存储型-xss-攻击"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#存储型-xss-攻击"}},[t._v("#")]),t._v(" 存储型 XSS 攻击")]),t._v(" "),n("p",[t._v("存储型 XSS 攻击向 HTML 文件中注入恶意脚本的方式可以参考下图：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(386),alt:"存储型 XSS 攻击"}})]),t._v(" "),n("p",[t._v("通过上图，可以看出存储型 XSS 攻击大致需要经过如下步骤：")]),t._v(" "),n("ul",[n("li",[t._v("首先黑客利用站点漏洞将一段恶意 JavaScript 代码提交到网站的数据库中")]),t._v(" "),n("li",[t._v("然后用户向网站请求包含了恶意 JavaScript 脚本的页面")]),t._v(" "),n("li",[t._v("当用户浏览该页面的时候，恶意脚本就会将用户的 Cookie 信息等数据上传到服务器")])]),t._v(" "),n("p",[t._v("一个实际例子，2015 年喜马拉雅就被曝出了存储型 XSS 漏洞。")]),t._v(" "),n("p",[t._v("起因是在用户设置专辑名称时，服务器对关键字过滤不严格，比如可以将专辑名称设置为一段 JavaScript，如下图所示：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(387),alt:"注入恶意脚本"}})]),t._v(" "),n("p",[t._v("当黑客将专辑名称设置为一段 JavaScript 代码并提交时，喜马拉雅的服务器会保存该段 JavaScript 代码到数据库中。")]),t._v(" "),n("p",[t._v("然后当用户打开黑客设置的专辑时，这段代码就会在用户的页面里执行（如下图），这样就可以获取用户的 Cookie 等数据信息。")]),t._v(" "),n("p",[n("img",{attrs:{src:a(388),alt:"盗取用户信息"}})]),t._v(" "),n("p",[t._v("当用户打开黑客设置的专辑页面时，服务器也会将这段恶意 JavaScript 代码返回给用户，因此这段恶意脚本就在用户的页面中执行。")]),t._v(" "),n("p",[t._v("恶意脚本可以通过 "),n("code",[t._v("XMLHttpRequest")]),t._v(" 或者 "),n("code",[t._v("Fetch")]),t._v(" 将用户的 Cookie 数据上传到黑客的服务器，如下图所示：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(389),alt:"上传到恶意服务器"}})]),t._v(" "),n("p",[t._v("黑客拿到用户 Cookie 信息之后，就可以利用 Cookie 信息在其他机器上登录该用户的账号（如下图），并利用用户账号进行一些恶意操作。")]),t._v(" "),n("p",[n("img",{attrs:{src:a(390),alt:"控制用户信息"}})]),t._v(" "),n("p",[t._v("以上就是存储型 XSS 攻击的一个典型案例。")]),t._v(" "),n("h3",{attrs:{id:"反射型-xss-攻击"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#反射型-xss-攻击"}},[t._v("#")]),t._v(" 反射型 XSS 攻击")]),t._v(" "),n("p",[t._v("在一个反射型 XSS 攻击过程中，恶意 JavaScript 脚本属于用户发送给网站请求中的一部分，随后网站又把恶意 JavaScript 脚本返回给用户。")]),t._v(" "),n("p",[t._v("当恶意 JavaScript 脚本在用户页面中被执行时，黑客就可以利用该脚本做一些恶意操作。")]),t._v(" "),n("p",[t._v("这样讲有点抽象，结合一个简单的 Node 服务程序来了解是反射型 XSS。")]),t._v(" "),n("p",[t._v("首先使用 Node 来搭建一个简单的页面环境，搭建好的服务代码如下所示：")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" express "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'express'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" router "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" express"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Router")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* GET home page. */")]),t._v("\nrouter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" next")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'index'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" title"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Express'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" xss"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("query"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xss "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nmodule"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" router\n")])])]),n("div",{staticClass:"language-html extra-class"},[n("pre",{pre:!0,attrs:{class:"language-html"}},[n("code",[t._v("\n"),n("span",{pre:!0,attrs:{class:"token doctype"}},[t._v("<!DOCTYPE html>")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("html")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("head")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("title")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("<%= title %>"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("title")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("link")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("rel")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("'")]),t._v("stylesheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("'")])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("href")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("'")]),t._v("/stylesheets/style.css"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("'")])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("head")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("body")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("h1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("<%= title %>"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("h1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("p")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("Welcome to <%= title %>"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("p")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    <%- xss %>\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("body")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("html")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),n("p",[t._v("上面这两段代码中，第一段是路由，第二段是视图，作用是将 URL 中 "),n("code",[t._v("xss")]),t._v(" 参数的内容显示在页面。")]),t._v(" "),n("p",[t._v("可以在本地演示下，比如打开 "),n("code",[t._v("http://localhost:3000/?xss=123")]),t._v(" 这个链接，这样在页面中展示就是 "),n("code",[t._v("123")]),t._v(" 。")]),t._v(" "),n("p",[n("img",{attrs:{src:a(391),alt:"正常打开页面"}})]),t._v(" "),n("p",[t._v("但当打开 "),n("code",[t._v("http://localhost:3000/?xss=<script>alert('你被xss攻击了')<\/script>")]),t._v(" 这段 URL 时，其结果如下图所示：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(392),alt:"反射型 XSS 攻击"}})]),t._v(" "),n("p",[t._v("通过这个操作，会发现用户将一段含有恶意代码的请求提交给 Web 服务器，Web 服务器接收到请求时，又将恶意代码反射给了浏览器端，这就是反射型 XSS 攻击。")]),t._v(" "),n("p",[t._v("在现实生活中，黑客经常会通过 QQ 群或者邮件等渠道诱导用户去点击这些恶意链接，所以对于一些链接一定要慎之又慎。")]),t._v(" "),n("h3",{attrs:{id:"基于-dom-的-xss-攻击"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#基于-dom-的-xss-攻击"}},[t._v("#")]),t._v(" 基于 DOM 的 XSS 攻击")]),t._v(" "),n("p",[t._v("基于 DOM 的 XSS 攻击是不牵涉到页面 Web 服务器的。")]),t._v(" "),n("p",[t._v("具体来讲，黑客通过各种手段将恶意脚本注入用户的页面中，比如通过网络劫持在页面传输过程中修改 HTML 页面的内容。")]),t._v(" "),n("p",[t._v("这种劫持类型很多，有通过 WiFi 路由器劫持的，有通过本地恶意软件来劫持的，它们的共同点是在 Web 资源传输过程或者在用户使用页面的过程中修改 Web 页面的数据。")]),t._v(" "),n("h2",{attrs:{id:"防御措施"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#防御措施"}},[t._v("#")]),t._v(" 防御措施")]),t._v(" "),n("p",[t._v("存储型 XSS 攻击和反射型 XSS 攻击都是需要经过 Web 服务器来处理的，因此可以认为这两种类型的漏洞是服务端的安全漏洞。")]),t._v(" "),n("p",[t._v("而基于 DOM 的 XSS 攻击全部都是在浏览器端完成的，因此基于 DOM 的 XSS 攻击是属于前端的安全漏洞。")]),t._v(" "),n("p",[t._v("无论是何种类型的 XSS 攻击，它们都有一个共同点，那就是首先往浏览器中注入恶意脚本，然后再通过恶意脚本将用户信息发送至黑客部署的恶意服务器上。")]),t._v(" "),n("p",[t._v("所以要阻止 XSS 攻击，可以通过阻止恶意 JavaScript 脚本的注入和恶意消息的发送来实现。")]),t._v(" "),n("h3",{attrs:{id:"服务器对输入脚本进行过滤或转码"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#服务器对输入脚本进行过滤或转码"}},[t._v("#")]),t._v(" 服务器对输入脚本进行过滤或转码")]),t._v(" "),n("p",[t._v("不管是反射型还是存储型 XSS 攻击，都可以在服务器端将一些关键的字符进行转码，比如最典型的：")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("code"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("script"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'你被xss攻击了'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("script"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),n("p",[t._v("这段代码过滤后，只留下了：")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("code"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n")])])]),n("p",[t._v("这样，当用户再次请求该页面时，由于 "),n("code",[t._v("<script>")]),t._v(" 标签的内容都被过滤了，所以这段脚本在客户端是不可能被执行的。")]),t._v(" "),n("p",[t._v("除了过滤之外，服务器还可以对这些内容进行转码，还是上面那段代码，经过转码之后，效果如下所示：")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("code"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("lt"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("script"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("gt"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("#"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("39")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("你被xss攻击了"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("#"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("39")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("lt"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("script"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("gt"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("经过转码之后的内容，如 "),n("code",[t._v("<script>")]),t._v(" 标签被转换为 "),n("code",[t._v("&lt;script&gt;")]),t._v("，因此即使这段脚本返回给页面，页面也不会执行这段脚本。")]),t._v(" "),n("h3",{attrs:{id:"充分利用-csp"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#充分利用-csp"}},[t._v("#")]),t._v(" 充分利用 CSP")]),t._v(" "),n("p",[t._v("虽然在服务器端执行过滤或者转码可以阻止 XSS 攻击的发生，但完全依靠服务器端依然是不够的，还需要把 CSP 等策略充分地利用起来，以降低 XSS 攻击带来的风险和后果。")]),t._v(" "),n("p",[t._v("实施严格的 CSP 可以有效地防范 XSS 攻击，具体来讲 CSP 有如下几个功能：")]),t._v(" "),n("ul",[n("li",[t._v("限制加载其他域下的资源文件，这样即使黑客插入了一个 JavaScript 文件，这个 JavaScript 文件也是无法被加载的")]),t._v(" "),n("li",[t._v("禁止向第三方域提交数据，这样用户数据也不会外泄")]),t._v(" "),n("li",[t._v("禁止执行内联脚本和未授权的脚本")]),t._v(" "),n("li",[t._v("提供上报机制，这样可以帮助尽快发现有哪些 XSS 攻击，以便尽快修复问题")])]),t._v(" "),n("h3",{attrs:{id:"使用-httponly-属性"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#使用-httponly-属性"}},[t._v("#")]),t._v(" 使用 HttpOnly 属性")]),t._v(" "),n("p",[t._v("由于很多 XSS 攻击都是来盗用 Cookie 的，因此还可以通过使用 "),n("code",[t._v("HttpOnly")]),t._v(" 属性来保护 Cookie 的安全。")]),t._v(" "),n("p",[t._v("通常服务器可以将某些 Cookie 设置为 "),n("code",[t._v("HttpOnly")]),t._v(" 标志，"),n("code",[t._v("HttpOnly")]),t._v(" 是服务器通过 HTTP 响应头来设置的，下面是打开 Google 时，HTTP 响应头中的一段：")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("cookie"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NID")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("189")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("M8q2FtWbsR8RlcldPVt7qkrqR38LmFY9jUxkKo3"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("Bi6Qu_ocNOat7nkYZUTzolHjFnwBw0izgsATSI7TZyiiiaV94qGh"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("BzEYsNVa7TZmjAYTxYTOM9L_"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("CN9ipL6cXi8l6"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("z41asXtm2uEwcOC5oh9djkffOMhWqQrlnCtOI"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" expires"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Sat"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Apr"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("06")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("52")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("GMT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" path"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" domain"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("google"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" HttpOnly\n")])])]),n("p",[t._v("可以看到，"),n("code",[t._v("set-cookie")]),t._v(" 属性值最后使用了 "),n("code",[t._v("HttpOnly")]),t._v(" 来标记该 Cookie。")]),t._v(" "),n("p",[t._v("顾名思义，使用 "),n("code",[t._v("HttpOnly")]),t._v(" 标记的 Cookie 只能使用在 HTTP 请求过程中，所以无法通过 JavaScript 来读取这段 Cookie。")]),t._v(" "),n("p",[t._v("还可以通过 Chrome 开发者工具来查看哪些 Cookie 被标记了 "),n("code",[t._v("HttpOnly")]),t._v("，如下图：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(393),alt:"HttpOnly"}})]),t._v(" "),n("p",[t._v("从图中可以看出，"),n("code",[t._v("NID")]),t._v(" 这个 Cookie 的 "),n("code",[t._v("HttpOlny")]),t._v(" 属性是被勾选上的，所以 "),n("code",[t._v("NID")]),t._v(" 的内容是无法通过 "),n("code",[t._v("document.cookie")]),t._v(" 是来读取的。")]),t._v(" "),n("p",[t._v("由于 JavaScript 无法读取设置了 "),n("code",[t._v("HttpOnly")]),t._v(" 的 Cookie 数据，所以即使页面被注入了恶意 JavaScript 脚本，也是无法获取到设置了 "),n("code",[t._v("HttpOnly")]),t._v(" 的数据。因此一些比较重要的数据建议设置 "),n("code",[t._v("HttpOnly")]),t._v(" 标志。")]),t._v(" "),n("h2",{attrs:{id:"csp"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#csp"}},[t._v("#")]),t._v(" CSP")]),t._v(" "),n("p",[t._v("CSP 的实质就是"),n("strong",[t._v("白名单制度")]),t._v("，开发者明确告诉客户端，哪些外部资源可以加载和执行，等同于提供白名单。它的实现和执行全部由浏览器完成，开发者只需提供配置。")]),t._v(" "),n("p",[t._v("CSP 大大增强了网页的安全性。攻击者即使发现了漏洞，也没法注入脚本，除非还控制了一台列入了白名单的可信主机。")]),t._v(" "),n("p",[t._v("两种方法可以启用 CSP。一种是通过 HTTP 头信息的 "),n("code",[t._v("Content-Security-Policy")]),t._v(" 字段。")]),t._v(" "),n("p",[n("img",{attrs:{src:a(394),alt:"Content-Security-Policy"}})]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("Content"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Security"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Policy"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" script"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("src "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'self'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" object"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("src "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'none'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nstyle"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("src cdn"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("example"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("org third"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("party"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" child"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("src https"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n")])])]),n("p",[t._v("另一种是通过网页的 "),n("code",[t._v("<meta>")]),t._v(" 标签：")]),t._v(" "),n("div",{staticClass:"language-html extra-class"},[n("pre",{pre:!0,attrs:{class:"language-html"}},[n("code",[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("meta")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("http-equiv")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("Content-Security-Policy"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("content")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("script-src 'self'; object-src 'none'; style-src cdn.example.org third-party.org; child-src https:"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),n("p",[t._v("上面代码中，CSP 做了如下配置：")]),t._v(" "),n("ul",[n("li",[t._v("脚本：只信任当前域名")]),t._v(" "),n("li",[n("code",[t._v("<object>")]),t._v(" 标签：不信任任何 URL，即不加载任何资源")]),t._v(" "),n("li",[t._v("样式表：只信任 "),n("code",[t._v("cdn.example.org")]),t._v(" 和 "),n("code",[t._v("third-party.org")])]),t._v(" "),n("li",[t._v("框架：必须使用 HTTPS 协议加载")]),t._v(" "),n("li",[t._v("其他资源：没有限制")])]),t._v(" "),n("p",[t._v("启用后，不符合 CSP 的外部资源就会被阻止加载。")]),t._v(" "),n("p",[t._v("Chrome 的报错信息：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(395),alt:"Chrome 报错"}})]),t._v(" "),n("h3",{attrs:{id:"限制选项"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#限制选项"}},[t._v("#")]),t._v(" 限制选项")]),t._v(" "),n("p",[t._v("CSP 提供了很多限制选项，涉及安全的各个方面。")]),t._v(" "),n("h4",{attrs:{id:"资源加载限制"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#资源加载限制"}},[t._v("#")]),t._v(" 资源加载限制")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("script-src")]),t._v("：外部脚本")]),t._v(" "),n("li",[n("code",[t._v("style-src")]),t._v("：样式表")]),t._v(" "),n("li",[n("code",[t._v("img-src")]),t._v("：图像")]),t._v(" "),n("li",[n("code",[t._v("media-src")]),t._v("：媒体文件（音频和视频）")]),t._v(" "),n("li",[n("code",[t._v("font-src")]),t._v("：字体文件")]),t._v(" "),n("li",[n("code",[t._v("object-src")]),t._v("：插件（如 Flash）")]),t._v(" "),n("li",[n("code",[t._v("child-src")]),t._v("：框架")]),t._v(" "),n("li",[n("code",[t._v("frame-ancestors")]),t._v("：嵌入的外部资源（比如 "),n("code",[t._v("<frame>")]),t._v("、"),n("code",[t._v("<iframe>")]),t._v("、"),n("code",[t._v("<embed>")]),t._v(" 和 "),n("code",[t._v("<apple>")]),t._v("）")]),t._v(" "),n("li",[n("code",[t._v("connect-src")]),t._v("：HTTP 连接（通过 "),n("code",[t._v("XMLHttpRequest")]),t._v("、"),n("code",[t._v("WebSockets")]),t._v("、"),n("code",[t._v("EventSource")]),t._v(" 等）")]),t._v(" "),n("li",[n("code",[t._v("worker-src")]),t._v("：worker 脚本")]),t._v(" "),n("li",[n("code",[t._v("manifest-src")]),t._v("：manifest 文件")])]),t._v(" "),n("p",[n("code",[t._v("default-src")]),t._v(" 用来设置上面各个选项的默认值。")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("Content"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Security"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Policy"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("src "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'self'")]),t._v("\n")])])]),n("p",[t._v("上面代码限制"),n("strong",[t._v("所有的")]),t._v("外部资源，都只能从当前域名加载。")]),t._v(" "),n("p",[t._v("如果同时设置某个单选限制（比如 "),n("code",[t._v("font-src")]),t._v("）和 "),n("code",[t._v("default-src")]),t._v("，前者会覆盖后者，即字体文件会采用 "),n("code",[t._v("font-src")]),t._v(" 的值，其他资源依然采用 "),n("code",[t._v("default-src")]),t._v(" 的值。")]),t._v(" "),n("h4",{attrs:{id:"url-限制"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#url-限制"}},[t._v("#")]),t._v(" URL 限制")]),t._v(" "),n("p",[t._v("有时，网页会跟其他 URL 发生联系，这时也可以加以限制：")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("frame-ancestors")]),t._v("：限制嵌入框架的网页")]),t._v(" "),n("li",[n("code",[t._v("base-uri")]),t._v("：限制 "),n("code",[t._v("<base#href>")])]),t._v(" "),n("li",[n("code",[t._v("form-action")]),t._v("：限制 "),n("code",[t._v("<form#action>")])])]),t._v(" "),n("h4",{attrs:{id:"其他限制"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#其他限制"}},[t._v("#")]),t._v(" 其他限制")]),t._v(" "),n("p",[t._v("其他一些安全相关的功能，也放在了 CSP 里面：")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("block-all-mixed-content")]),t._v("：HTTPS 网页不得加载 HTTP 资源（浏览器已经默认开启）")]),t._v(" "),n("li",[n("code",[t._v("upgrade-insecure-requests")]),t._v("：自动将网页上所有加载外部资源的 HTTP 链接换成 HTTPS 协议")]),t._v(" "),n("li",[n("code",[t._v("plugin-types")]),t._v("：限制可以使用的插件格式")]),t._v(" "),n("li",[n("code",[t._v("sandbox")]),t._v("：浏览器行为的限制，比如不能有弹出窗口等")])]),t._v(" "),n("h4",{attrs:{id:"report-uri"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#report-uri"}},[t._v("#")]),t._v(" report-uri")]),t._v(" "),n("p",[t._v("有时，不仅希望防止 XSS，还希望记录此类行为。"),n("code",[t._v("report-uri")]),t._v(" 就用来告诉浏览器，应该把注入行为报告给哪个网址。")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("Content"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Security"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Policy"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("src "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'self'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" report"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("uri "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("my_amazing_csp_report_parser"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("上面代码指定，将注入行为报告给 "),n("code",[t._v("/my_amazing_csp_report_parser")]),t._v(" 这个 URL。")]),t._v(" "),n("p",[t._v("浏览器会使用 "),n("code",[t._v("POST")]),t._v(" 方法发送一个JSON对象，下面是一个例子。")]),t._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"csp-report"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"document-uri"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://example.org/page.html"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"referrer"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://evil.example.com/"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"blocked-uri"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://evil.example.com/evil.js"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"violated-directive"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"script-src 'self' https://apis.google.com\"")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"original-policy"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"script-src 'self' https://apis.google.com; report-uri http://example.org/my_amazing_csp_report_parser\"")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[n("img",{attrs:{src:a(396),alt:"POST CSP"}})]),t._v(" "),n("h4",{attrs:{id:"content-security-policy-report-only"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#content-security-policy-report-only"}},[t._v("#")]),t._v(" Content-Security-Policy-Report-Only")]),t._v(" "),n("p",[t._v("除了 "),n("code",[t._v("Content-Security-Policy")]),t._v("，还有一个 "),n("code",[t._v("Content-Security-Policy-Report-Only")]),t._v(" 字段，表示不执行限制选项，只是记录违反限制的行为。")]),t._v(" "),n("p",[t._v("它必须与 "),n("code",[t._v("report-uri")]),t._v(" 选项配合使用：")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("Content"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Security"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Policy"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Report"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Only"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("src "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'self'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" report"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("uri "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("my_amazing_csp_report_parser"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"选项值"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#选项值"}},[t._v("#")]),t._v(" 选项值")]),t._v(" "),n("p",[t._v("每个限制选项可以设置以下几种值，这些值就构成了白名单：")]),t._v(" "),n("ul",[n("li",[t._v("主机名："),n("code",[t._v("example.org")]),t._v("，"),n("code",[t._v("https://example.com:443")])]),t._v(" "),n("li",[t._v("路径名："),n("code",[t._v("example.org/resources/js/")])]),t._v(" "),n("li",[t._v("通配符："),n("code",[t._v("*.example.org")]),t._v("，"),n("code",[t._v("*://example.com:*")]),t._v("（表示任意协议、任意子域名、任意端口）")]),t._v(" "),n("li",[t._v("协议名："),n("code",[t._v("https:")]),t._v("、"),n("code",[t._v("data:")])]),t._v(" "),n("li",[t._v("关键字 "),n("code",[t._v("'self'")]),t._v("：当前域名、需要加引号")]),t._v(" "),n("li",[t._v("关键字 "),n("code",[t._v("‘none’")]),t._v("：禁止加载任何外部资源，需要加引号")])]),t._v(" "),n("p",[t._v("多个值也可以并列，用空格分隔：")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("Content"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Security"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Policy"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" script"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("src "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'self'")]),t._v(" https"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("apis"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("google"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com\n")])])]),n("p",[t._v("如果同一个限制选项使用多次，只有第一次会生效：")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 错误的写法")]),t._v("\nscript"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("src https"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("host1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" script"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("src https"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("host2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//正确的写法")]),t._v("\nscript"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("src https"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("host1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com https"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("host2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com\n")])])]),n("p",[t._v("如果不设置某个限制选项，就是默认允许任何值。")]),t._v(" "),n("h3",{attrs:{id:"script-src-的特殊值"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#script-src-的特殊值"}},[t._v("#")]),t._v(" script-src 的特殊值")]),t._v(" "),n("p",[t._v("除了常规值，"),n("code",[t._v("script-src")]),t._v(" 还可以设置一些特殊值。注意，下面这些值都必须放在单引号里面。")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("'unsafe-inline'")]),t._v("： 允许执行页面内嵌的 "),n("code",[t._v("<script>")]),t._v(" 标签和事件监听函数")]),t._v(" "),n("li",[n("code",[t._v("‘unsafe-eval’")]),t._v("： 允许将字符串当作代码执行，比如使用 "),n("code",[t._v("eval")]),t._v("、"),n("code",[t._v("setTimeout")]),t._v("、"),n("code",[t._v("setInterval")]),t._v(" 和 "),n("code",[t._v("Function")]),t._v(" 等函数")]),t._v(" "),n("li",[n("code",[t._v("‘nonce’")]),t._v(" 值： 每次 HTTP 回应给出一个授权 token，页面内嵌脚本必须有这个 token，才会执行")]),t._v(" "),n("li",[n("code",[t._v("‘hash’")]),t._v(" 值： 列出允许执行的脚本代码的 hash 值，页面内嵌脚本的哈希值只有吻合的情况下，才能执行")])]),t._v(" "),n("p",[n("code",[t._v("nonce")]),t._v(" 值的例子如下，服务器发送网页的时候，告诉浏览器一个随机生成的 token：")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("Content"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Security"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Policy"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" script"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("src "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'nonce-EDNnf03nceIOfn39fn3e9h3sdfa'")]),t._v("\n")])])]),n("p",[t._v("页面内嵌脚本，必须有这个 token 才能执行：")]),t._v(" "),n("div",{staticClass:"language-html extra-class"},[n("pre",{pre:!0,attrs:{class:"language-html"}},[n("code",[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("nonce")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v("EDNnf03nceIOfn39fn3e9h3sdfa")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token script"}},[n("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// some code")]),t._v("\n")])]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),n("p",[n("code",[t._v("hash")]),t._v(" 值的例子如下，服务器给出一个允许执行的代码的 hash 值：")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("Content"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Security"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Policy"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" script"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("src "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sha256-qznLcsROx4GACP2dm0UCKCzCG-HiZ1guq6ZZDob_Tng='")]),t._v("\n")])])]),n("p",[t._v("下面的代码就会允许执行，因为 hash 值相符：")]),t._v(" "),n("div",{staticClass:"language-html extra-class"},[n("pre",{pre:!0,attrs:{class:"language-html"}},[n("code",[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token script"}},[n("span",{pre:!0,attrs:{class:"token language-javascript"}},[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Hello, world.'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")])])]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),n("p",[t._v("计算 hash 值的时候，"),n("code",[t._v("<script>")]),t._v(" 标签不算在内。")]),t._v(" "),n("p",[t._v("除了 "),n("code",[t._v("script-src")]),t._v(" 选项，"),n("code",[t._v("nonce")]),t._v(" 值和 "),n("code",[t._v("hash")]),t._v(" 值还可以用在 "),n("code",[t._v("style-src")]),t._v(" 选项，控制页面内嵌的样式表。")]),t._v(" "),n("h3",{attrs:{id:"注意点"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#注意点"}},[t._v("#")]),t._v(" 注意点")]),t._v(" "),n("ol",[n("li",[n("p",[n("code",[t._v("script-src")]),t._v(" 和 "),n("code",[t._v("object-src")]),t._v(" 是必需的，除非设置了 "),n("code",[t._v("default-src")])]),t._v(" "),n("p",[t._v("因为攻击者只要能注入脚本，其他限制都可以规避。而 "),n("code",[t._v("object-src")]),t._v(" 必设是因为 Flash 里面可以执行外部脚本。")])]),t._v(" "),n("li",[n("p",[n("code",[t._v("script-src")]),t._v(" 不能使用 "),n("code",[t._v("unsafe-inline")]),t._v(" 关键字（除非伴随一个 "),n("code",[t._v("nonce")]),t._v(" 值），也不能允许设置 "),n("code",[t._v("data:")]),t._v(" URL")]),t._v(" "),n("p",[t._v("下面是两个恶意攻击的例子：")]),t._v(" "),n("div",{staticClass:"language-html extra-class"},[n("pre",{pre:!0,attrs:{class:"language-html"}},[n("code",[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("img")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("onerror")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("evil()"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("data:text/javascript,evil()"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token script"}}),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])])]),t._v(" "),n("li",[n("p",[t._v("必须特别注意 JSONP 的回调函数")]),t._v(" "),n("div",{staticClass:"language-html extra-class"},[n("pre",{pre:!0,attrs:{class:"language-html"}},[n("code",[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("/path/jsonp?callback=alert(document.domain)//"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token script"}}),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),n("p",[t._v("上面的代码中，虽然加载的脚本来自当前域名，但是通过改写回调函数，攻击者依然可以执行恶意代码。")])])])])}),[],!1,null,null,null);s.default=e.exports},386:function(t,s,a){t.exports=a.p+"assets/img/04-stroage-xss-1.492f179c.png"},387:function(t,s,a){t.exports=a.p+"assets/img/04-stroage-xss-2.412813a2.png"},388:function(t,s,a){t.exports=a.p+"assets/img/04-stroage-xss-3.ef451895.png"},389:function(t,s,a){t.exports=a.p+"assets/img/04-stroage-xss-4.87ed8d82.png"},390:function(t,s,a){t.exports=a.p+"assets/img/04-stroage-xss-5.728ea5c5.png"},391:function(t,s){t.exports="data:image/png;base64,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"},392:function(t,s,a){t.exports=a.p+"assets/img/04-reflective-xss-2.1941ac1b.png"},393:function(t,s,a){t.exports=a.p+"assets/img/04-httponly.44124fc5.png"},394:function(t,s,a){t.exports=a.p+"assets/img/04-csp-1.2f6dd848.jpg"},395:function(t,s,a){t.exports=a.p+"assets/img/04-csp-2.b19e955c.png"},396:function(t,s,a){t.exports=a.p+"assets/img/04-csp-3.1b7ed028.png"}}]);