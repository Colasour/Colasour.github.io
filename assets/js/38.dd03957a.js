(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{297:function(v,_,t){"use strict";t.r(_);var e=t(35),s=Object(e.a)({},(function(){var v=this,_=v.$createElement,e=v._self._c||_;return e("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[e("h1",{attrs:{id:"frontmatter-title"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#frontmatter-title"}},[v._v("#")]),v._v(" "+v._s(v.$frontmatter.title))]),v._v(" "),e("h2",{attrs:{id:"域名形式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#域名形式"}},[v._v("#")]),v._v(" 域名形式")]),v._v(" "),e("p",[v._v("域名是一个有层次的结构，是一串用 "),e("code",[v._v(".")]),v._v(" 分隔的多个单词，最右边的被称为“顶级域名”，然后是“二级域名”，层次关系向左依次降低。")]),v._v(" "),e("p",[v._v("最左边的是主机名，通常用来表明主机的用途，比如 "),e("code",[v._v("www")]),v._v(" 表示提供万维网服务，"),e("code",[v._v("mail")]),v._v(" 表示提供邮件服务，不过这也不是绝对的，名字的关键是为了容易记忆。")]),v._v(" "),e("p",[v._v("域名不仅能够代替 IP 地址，还有许多其他的用途。在 Apache、Nginx 这样的 Web 服务器里，域名可以用来"),e("strong",[v._v("标识虚拟主机")]),v._v("，决定由哪个虚拟主机来对外提供服务。比如在 Nginx 里就会使用 "),e("code",[v._v("server_name")]),v._v(" 指令：")]),v._v(" "),e("div",{staticClass:"language-nginx extra-class"},[e("pre",{pre:!0,attrs:{class:"language-nginx"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[v._v("server")]),v._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[v._v("{")]),v._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[v._v("listen")]),v._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[v._v("80")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[v._v(";")]),v._v("                  "),e("span",{pre:!0,attrs:{class:"token comment"}},[v._v("# 监听 80 端口")]),v._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[v._v("server_name")]),v._v(" www"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[v._v(".")]),v._v("baidu"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[v._v(".")]),v._v("com"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[v._v(";")]),v._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[v._v("# 主机名是 www.baidu.com")]),v._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[v._v("}")]),v._v("\n")])])]),e("p",[v._v("域名本质上还是个名字空间系统，使用多级域名就可以划分出不同的国家、地区、组织、公司、部分，每个域名都是独一无二的，可以作为一种身份的标识。")]),v._v(" "),e("p",[v._v("因为这个特性，域名也被扩展到了其他应用领域，比如 Java 的包机制就采用域名作为命名空间，只是它使用了反序。而 XML 里使用 URI 作为名字空间，也是间接使用了域名。")]),v._v(" "),e("h2",{attrs:{id:"域名解析"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#域名解析"}},[v._v("#")]),v._v(" 域名解析")]),v._v(" "),e("p",[v._v("就像 IP 地址必须转换成 MAC 地址才能访问主机一样，域名也必须要转换成 IP 地址，这个过程就是"),e("strong",[v._v("域名解析")]),v._v("。")]),v._v(" "),e("p",[v._v("DNS 的核心系统是一个三层的树状、分布式访问，基本对应域名的结构：")]),v._v(" "),e("ol",[e("li",[e("p",[e("strong",[v._v("根域名服务器 (Root DNS Server)")]),v._v("：管理顶级域名服务器，返回 "),e("code",[v._v("com")]),v._v("、"),e("code",[v._v("net")]),v._v("、"),e("code",[v._v("cn")]),v._v(" 等顶级域名服务器的 IP 地址")])]),v._v(" "),e("li",[e("p",[e("strong",[v._v("顶级域名服务器 (Top-level DNS Server)")]),v._v("：管理各自域名下的权威域名服务器，比如 "),e("code",[v._v("com")]),v._v(" 顶级域名服务器可以返回 "),e("code",[v._v("apple.com")]),v._v(" 域名服务器的 IP 地址")])]),v._v(" "),e("li",[e("p",[e("strong",[v._v("权威域名服务器 (Authoritative DNS Server)")]),v._v("：管理自己域名下主机的 IP 地址，比如 "),e("code",[v._v("apple.com")]),v._v(" 权威域名服务器可以返回 "),e("code",[v._v("www.apple.com")]),v._v(" 的 IP 地址")])])]),v._v(" "),e("p",[e("img",{attrs:{src:t(496),alt:"DNS Server"}})]),v._v(" "),e("p",[v._v("例如访问 "),e("code",[v._v("www.apple.com")]),v._v("，需要进行下面的三次查询：")]),v._v(" "),e("ol",[e("li",[v._v("访问根域名服务器，它会告诉 "),e("code",[v._v("com")]),v._v(" 顶级域名服务器的地址")]),v._v(" "),e("li",[v._v("访问 "),e("code",[v._v("com")]),v._v(" 顶级域名服务器，它会告诉 "),e("code",[v._v("apple.com")]),v._v(" 域名服务器的地址")]),v._v(" "),e("li",[v._v("最后访问 "),e("code",[v._v("apple.com")]),v._v(" 域名服务器，得到了 "),e("code",[v._v("www.apple.com")]),v._v(" 的地址")])]),v._v(" "),e("h3",{attrs:{id:"dns-缓存"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#dns-缓存"}},[v._v("#")]),v._v(" DNS 缓存")]),v._v(" "),e("p",[v._v("虽然核心的 DNS 系统遍布全球，服务能力很强也很稳定，但如果全世界的网民都往这个系统里挤，即使不瘫痪，访问速度也会很慢。所以在核心的 DNS 系统之外，还有另种手段来减轻域名解析的压力，并且能够更快地获取结果，基本思路就是“"),e("strong",[v._v("缓存")]),v._v("”。")]),v._v(" "),e("p",[v._v("首先，许多大公司、网络运行商都会建立自己的 DNS 服务器，作为用户 DNS 查询的代理，代替用户访问核心 DNS 系统。这些“野生”服务器被称为“"),e("strong",[v._v("非权威域名服务器")]),v._v("”，可以缓存之前的查询结果，如果已经有了记录，就无需再向根服务器发起查询，直接返回对应的 IP 地址。")]),v._v(" "),e("p",[v._v("这些 DNS 服务器的数量要比核心系统的服务器多很多，而且大多部署在离用户很近的地方。比较知名的 DNS 有 Google 的 "),e("code",[v._v("8.8.8.8")]),v._v("，Microsoft 的 "),e("code",[v._v("4.2.2.1")]),v._v("，还有 CloudFlare 的 "),e("code",[v._v("1.1.1.1")]),v._v(" 等等。")]),v._v(" "),e("p",[v._v("其次，操作系统也会对 DNS 解析结果做缓存，如果之前访问过 "),e("code",[v._v("www.apple.com")]),v._v("，那么下次在浏览器输入这个地址时便直接在操作系统里就可以拿到 IP 地址。")]),v._v(" "),e("p",[v._v("另外，操作系统里还有一个特殊的“主机映射”的文件，通常是一个可编辑的文本。在 Linux 里是 "),e("code",[v._v("/etc/hosts")]),v._v("；在 Windows 里是 "),e("code",[v._v("C:\\WINDOWS\\system32\\drivers\\etc\\hosts")]),v._v("。如果操作系统在缓存里找不到 DNS 记录，就会找这个文件。")]),v._v(" "),e("p",[e("img",{attrs:{src:t(497),alt:"DNS 架构"}})]),v._v(" "),e("h2",{attrs:{id:"域名解析过程"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#域名解析过程"}},[v._v("#")]),v._v(" 域名解析过程")]),v._v(" "),e("p",[v._v("❔ 在浏览器地址栏里随便输入一个不存在的域名，比如就叫 "),e("code",[v._v("www.不存在.com")]),v._v("，试着解释它的 DNS 解析过程。")]),v._v(" "),e("ol",[e("li",[v._v("检查浏览器缓存")]),v._v(" "),e("li",[v._v("检查本地 DNS 缓存是否存在解析 "),e("code",[v._v("www.不存在.com")]),v._v(" 域名的 IP")]),v._v(" "),e("li",[v._v("如果没有检查本地 "),e("code",[v._v("hosts")]),v._v(" 文件是否有对应的固定记录")]),v._v(" "),e("li",[v._v("如果没有就根据本地网卡被分配的非权威域名服务器进行解析")]),v._v(" "),e("li",[v._v("如果没有缓存或者缓存失败，就先去顶级域名服务器 "),e("code",[v._v("com")]),v._v(" 查找 "),e("code",[v._v("不存在.com")]),v._v(" 的域名服务器 IP，结果发现不存在，于是直接返回告诉浏览器域名解析错误")])])])}),[],!1,null,null,null);_.default=s.exports},496:function(v,_,t){v.exports=t.p+"assets/img/DNSServer.6b020454.png"},497:function(v,_,t){v.exports=t.p+"assets/img/DNS.e51df324.png"}}]);